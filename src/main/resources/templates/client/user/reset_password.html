<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>애니팅 | 반려동물 추천 AI</title>

  <link rel="icon" type="image/png" href="drool_assets/images/favicon.png">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Poppins:400,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="drool_assets/css/style.css" />
  <link rel="stylesheet" href="drool_assets/css/responsive.css" />
  <style>
    .login-wrapper {
      background: white;
      border-radius: 30px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
      padding: 3rem;
    }
    .welcome-box {
      background: linear-gradient(135deg, #fff1c1, #fdd49a);
      border-radius: 25px;
      min-width: 200px;
      max-width: 350px;
      flex: 1 1 0;
    }
    .login-box input {
      background: #fff8dc;
      border: none;
    }
    .login-box button {
      background: linear-gradient(135deg, #ffd95c, #ff8c00);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    @media (max-width: 768px) {
      .login-wrapper {
        padding: 2rem;
        flex-direction: column !important;
      }
      .welcome-box {
        margin-bottom: 2rem;
        border-radius: 20px;
      }
    }
  </style>
</head>

<body>
  <div class="hero_area">
    <header class="header_section">
      <div class="container-fluid">
        <nav class="navbar navbar-expand-lg custom_nav-container">
          <a class="navbar-brand" href="/">
            <img src="drool_assets/images/logo.png" alt="logo">
          </a>
        </nav>
      </div>
    </header>

    <section class="slider_section">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col-md-6 offset-md-1">
            <div class="login-wrapper d-flex flex-md-row flex-column align-items-start justify-content-between flex-wrap gap-4" style="width: 100%;">
              
              <!-- 왼쪽 안내 -->
              <div class="welcome-box p-5 me-md-4 mb-4 mb-md-0">
                <h4 class="fw-bold mb-4">비밀번호를 재설정하세요</h4>
                <h5 class="fw-semibold mb-3">새로운 비밀번호를 입력해주세요</h5>
                <p class="text-dark mb-0" style="line-height: 1.8;">
                  보안을 위해 이전과 다른 비밀번호를 설정해주세요.<br><br>
                  비밀번호는 암호화되어 안전하게 저장됩니다.
                </p>
              </div>

              <!-- 비밀번호 재설정 폼 -->
              <div class="login-box" style="min-width: 320px;">
                <h5 class="text-end fw-bold mb-4" style="color: #ff8c00;">RESET PASSWORD</h5>
                <form>
                  <div class="mb-3">
                    <label class="form-label">새 비밀번호</label>
                    <input type="password" class="form-control rounded-pill px-4 py-2 border-0 shadow-sm" placeholder="새 비밀번호 입력" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">비밀번호 확인</label>
                    <input type="password" class="form-control rounded-pill px-4 py-2 border-0 shadow-sm" placeholder="다시 입력" required>
                  </div>
                  <button type="submit" class="btn w-100 py-2 rounded-pill text-white fw-semibold">저장하기</button>
                  <p class="text-center mt-4 text-muted small">
                    이미 변경하셨나요?
                    <a href="login" class="fw-semibold text-decoration-none" style="color: #ff8c00;">로그인</a>
                  </p>
                </form>
              </div>

            </div>
          </div>

          <!-- 오른쪽 일러스트 -->
          <div class="col-md-4">
            <div class="img-box text-center">
              <img src="drool_assets/images/slider-img.png" alt="반려동물 일러스트" class="img-fluid">
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script src="drool_assets/js/jquery-3.4.1.min.js"></script>
  <script src="drool_assets/js/bootstrap.js"></script>
  <script>
  
	  $(function () {

	    $("form").submit(function (e) {

	      e.preventDefault();
	
	      const newPassword = $("input[placeholder='새 비밀번호 입력']").val();
	      const confirmPassword = $("input[placeholder='다시 입력']").val();
	
	      if (newPassword !== confirmPassword) {
	        alert("비밀번호가 일치하지 않습니다.");
	        return;
	      }
	
	      const usersId = localStorage.getItem("recoveringUserId");
	      if (!usersId) {
	        alert("인증 정보가 없습니다. 처음부터 다시 진행해주세요.");
	        location.href = "/find_password.html";
	        return;
	      }
	
	      $.ajax({

	        url: "/api/users/reset_password",
	        method: "POST",
	        contentType: "application/json",
	        data: JSON.stringify({ usersId, newPassword }),
	        success: function () {
	          alert("비밀번호가 성공적으로 변경되었습니다.");
	          localStorage.removeItem("recoveringUserId");
	          location.href = "/";
	        },
	        error: function () {
	          alert("비밀번호 재설정에 실패했습니다.");
	        }
	        
	      });
	      
	    });
	    
	  });
	  
	</script>
  
</body>
</html>
